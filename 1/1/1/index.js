(()=>{"use strict";var e={206:(e,t,i)=>{i.d(t,{F:()=>n});class n{constructor(){this.sdkScript="http://pubh5sdk-uat.iwgame.com/index.js",this.sdkType="",this.publisherFuncList={init:window.x8Sdk.init,login:window.x8Sdk.login,pay:window.x8Sdk.pay,submitLog:window.x8Sdk.submitData,getDeviceInfo:window.x8Sdk.getDeviceInfo,logout:window.x8Sdk.logout}}init(e){const{game_version:t,appkey:i}=e;return new Promise(((e,i)=>{this.publisherFuncList.init({appkey:"a657ba4a70244d83bd9105aa63ba0fea",game_version:t,callback:t=>{200==t.code?e(!0):i(!1)}})}))}login(){return new Promise(((e,t)=>{this.publisherFuncList.login({callback:t=>{200==t.code&&e({code:200,data:t.data})}})}))}pay(e){const{order_money_type:t="CNY",order_amount:i,pay_order_id:n,x8_order_id:s,product_id:r,product_name:a="",product_desc:o="",role_id:d,role_name:c="",role_level:l="",role_prof:p="",role_sex:u="",role_vip_level:_="",server_id:h,server_name:g=""}=e;return new Promise(((e,m)=>{this.publisherFuncList.pay({info:{order_money_type:t,order_amount:i,pay_order_id:n,x8_order_id:s,product_id:r,product_name:a,product_desc:o,role_id:d,role_name:c,role_level:l,role_prof:p,role_sex:u,role_vip_level:_,server_id:h,server_name:g},callback:t=>{e(!0)}})}))}logout(){this.publisherFuncList.logout({callback:()=>{}}),window.location.reload()}}},147:e=>{e.exports=JSON.parse('{"name":"cph5sdk","version":"4.0.5","scripts":{"webpack:help":"webpack --help","server":"http-server dist/","server:cors":"http-server dist/ --cors","watch":"webpack --env envPath=./.env watch=true","dev":"npm run watch & npm run server","dev:cors":"npm run dev & npm run server:cors","build:dev":"webpack --env envPath=./.env","build":"webpack --env envPath=./.env.prod","build:zip":"sh ./build/buildZip.sh"},"sideEffects":["./src/devices/h5.js","./src/devices/android.js","./src/devices/ios.js","./src/publisher/lvantest/index.js"],"type":"commonjs","devDependencies":{"@babel/core":"^7.19.1","@babel/plugin-transform-runtime":"^7.19.1","@babel/polyfill":"^7.12.1","@babel/preset-env":"^7.19.1","babel-loader":"^8.2.5","cross-env":"^7.0.3","dotenv-webpack":"^8.0.1","filehound":"^1.17.6","ts-loader":"^9.4.1","tslib":"^2.4.0","ttypescript":"^1.5.13","typescript":"^4.8.3","typescript-transform-paths":"^3.3.1","webpack":"^5.74.0","webpack-cli":"^4.10.0"},"dependencies":{"base-h5sdk":"^1.0.3","clean-webpack-plugin":"^4.0.0","dotenv":"^16.0.2","module-alias":"^2.2.2","ts-md5":"^1.2.11","tsc-alias":"^1.7.0"}}')}},t={};function i(n){var s=t[n];if(void 0!==s)return s.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,i),r.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;function t(){var e=performance.timing?performance.timing.navigationStart:performance.timeOrigin;return 1e3*(performance.now()+e)}function n(e,t){return(e+"").length>=t?e+"":new Array(t+1-(e+"").length).join("0")+e}function s(){var e=navigator.userAgent,t="";if(e.indexOf("Mac OS X")>-1)t="IOS "+(e.match(/OS [\d._]*/gi)+"").replace(/[^0-9|_.]/gi,"").replace(/_/gi,".");else if(e.indexOf("Android")>-1||e.indexOf("Linux")>-1)t="Android "+e.substr(e.indexOf("Android")+8,e.indexOf(";",e.indexOf("Android"))-e.indexOf("Android")-8);else if(e.indexOf("BB10")>-1)t="blackberry "+e.substr(e.indexOf("BB10")+5,e.indexOf(";",e.indexOf("BB10"))-e.indexOf("BB10")-5);else if(e.indexOf("IEMobile")>-1)t="winphone "+e.substr(e.indexOf("IEMobile")+9,e.indexOf(";",e.indexOf("IEMobile"))-e.indexOf("IEMobile")-9);else{var i=navigator.userAgent.toLowerCase();t=i.indexOf("windows nt 5.0")>-1?"Windows 2000":i.indexOf("windows nt 5.1")>-1||i.indexOf("windows nt 5.2")>-1?"Windows XP":i.indexOf("windows nt 6.0")>-1?"Windows Vista":i.indexOf("windows nt 6.1")>-1||i.indexOf("windows 7")>-1?"Windows 7":i.indexOf("windows nt 6.2")>-1||i.indexOf("windows 8")>-1?"Windows 8":i.indexOf("windows nt 6.3")>-1?"Windows 8.1":i.indexOf("windows nt 6.2")>-1||i.indexOf("windows nt 10.0")>-1?"Windows 10":"Unknown"}return t.toLocaleLowerCase()}function r(){let e=localStorage.getItem("cp_unFirstActive")?0:1;return localStorage.setItem("cp_unFirstActive","1"),e+""}!function(e){e.dev="dev",e.uat="uat",e.master="master"}(e||(e={}));class a{constructor(){this.urlParams=this.analysis()}static getInstance(){return this.instance}analysis(){return(e=>{let t={};return e.split("&").map((e=>{let i=e.split("=");t[i[0]]=i[1]})),t})(location.search.slice(1,location.search.length))}get(e){return this.urlParams[e]}getAll(){return this.urlParams}getIsAndroid(){return Boolean(a.getInstance().get("android"))}getIsIos(){return Boolean(a.getInstance().get("ios"))}getIsApp(){return Boolean(a.getInstance().get("isApp"))}getPubisherId(){return a.getInstance().get("pubId")}getPubisherCode(){return a.getInstance().get("pubCode")}getGameId(){return a.getInstance().get("gameId")}getZoneId(){return a.getInstance().get("zoneId")}getTunnelId(){return a.getInstance().get("tunnelId")}}a.instance=new a;class o{static common(...t){"dev"!=e.master&&console.log("[cpsdk][debugger log]:",...t)}static commonS(...t){("dev"!=e.master||"debug"==a.getInstance().get("logDebug"))&&console.log("[cpsdk][info]:",...t)}static error(...t){"dev"!=e.master&&console.error("[cpsdk][error]:",...t)}static warn(...t){"dev"!=e.master&&console.warn("[cpsdk][warnning]:",...t)}static timeStart(i){if("dev"!=e.master)return this.logTimeState.hasOwnProperty(i)&&this.error(`logName ${i} is exist`),this.logTimeState[i]=t(),console.log(`[cpsdk][timer]:start ${i}`),i}static timeEnd(i){if("dev"!=e.master){this.logTimeState.hasOwnProperty(i)||this.error(`logName ${i} is not exist`);const e=t()-this.logTimeState[i];return console.log(`[cpsdk][timer]:end ${i} --${e}μs`),e}}}o.logTimeState={};class d{static requestGet(e){const{url:t,data:i={},success:n=null,fail:s=null,header:r={}}=e;let a=function(e){let t="";for(let i in e)t+=`${i}=${e[i]}&`;return t.slice(0,t.length-1)}(i);var o=new XMLHttpRequest;o.open("GET",t+"?"+decodeURIComponent(a),!0),o.onreadystatechange=function(){let e=null;if(4==o.readyState&&200==o.status||304==o.status){try{e="string"==typeof o.responseText?JSON.parse(o.responseText):o.responseText}catch(t){e=o.responseText}n&&n.call(this,e)}else o.status&&200!=o.status&&s&&s.call(this,e)},o.send()}static requestPost(e){const{url:t,data:i={},success:n=null,fail:s=null,header:r={},ext:a={}}=e;var o=new XMLHttpRequest;o.open("POST",t,!0),a.notX8||o.setRequestHeader("Content-Type","application/json;charset=UTF-8");for(const e in r)o.setRequestHeader(e,r[e]);o.onreadystatechange=function(){let e=null;if(4==o.readyState&&200==o.status||304==o.status){try{e="string"==typeof o.responseText?JSON.parse(o.responseText):o.responseText}catch(t){e=o.responseText}n&&n.call(this,e)}else o.status&&200!=o.status&&s&&s.call(this,e)},o.send(JSON.stringify(i))}static create(e){const{url:t,type:i="get",data:n={},header:s={},ext:r={}}=e;return new Promise(((e,a)=>{switch(null==i?void 0:i.toLowerCase()){case"get":this.requestGet({url:t,data:n,header:s,ext:r,success:t=>{e(t)},fail:e=>{a(e)}});break;case"post":this.requestPost({url:t,data:n,header:s,ext:r,success:t=>{e(t)},fail:e=>{a(e)}})}}))}}class c{constructor(){this._dataLength=0,this._bufferLength=0,this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashStr(e,t=!1){return this.onePassHasher.start().appendStr(e).end(t)}static hashAsciiStr(e,t=!1){return this.onePassHasher.start().appendAsciiStr(e).end(t)}static _hex(e){const t=c.hexChars,i=c.hexOut;let n,s,r,a;for(a=0;a<4;a+=1)for(s=8*a,n=e[a],r=0;r<8;r+=2)i[s+1+r]=t.charAt(15&n),n>>>=4,i[s+0+r]=t.charAt(15&n),n>>>=4;return i.join("")}static _md5cycle(e,t){let i=e[0],n=e[1],s=e[2],r=e[3];i+=(n&s|~n&r)+t[0]-680876936|0,i=(i<<7|i>>>25)+n|0,r+=(i&n|~i&s)+t[1]-389564586|0,r=(r<<12|r>>>20)+i|0,s+=(r&i|~r&n)+t[2]+606105819|0,s=(s<<17|s>>>15)+r|0,n+=(s&r|~s&i)+t[3]-1044525330|0,n=(n<<22|n>>>10)+s|0,i+=(n&s|~n&r)+t[4]-176418897|0,i=(i<<7|i>>>25)+n|0,r+=(i&n|~i&s)+t[5]+1200080426|0,r=(r<<12|r>>>20)+i|0,s+=(r&i|~r&n)+t[6]-1473231341|0,s=(s<<17|s>>>15)+r|0,n+=(s&r|~s&i)+t[7]-45705983|0,n=(n<<22|n>>>10)+s|0,i+=(n&s|~n&r)+t[8]+1770035416|0,i=(i<<7|i>>>25)+n|0,r+=(i&n|~i&s)+t[9]-1958414417|0,r=(r<<12|r>>>20)+i|0,s+=(r&i|~r&n)+t[10]-42063|0,s=(s<<17|s>>>15)+r|0,n+=(s&r|~s&i)+t[11]-1990404162|0,n=(n<<22|n>>>10)+s|0,i+=(n&s|~n&r)+t[12]+1804603682|0,i=(i<<7|i>>>25)+n|0,r+=(i&n|~i&s)+t[13]-40341101|0,r=(r<<12|r>>>20)+i|0,s+=(r&i|~r&n)+t[14]-1502002290|0,s=(s<<17|s>>>15)+r|0,n+=(s&r|~s&i)+t[15]+1236535329|0,n=(n<<22|n>>>10)+s|0,i+=(n&r|s&~r)+t[1]-165796510|0,i=(i<<5|i>>>27)+n|0,r+=(i&s|n&~s)+t[6]-1069501632|0,r=(r<<9|r>>>23)+i|0,s+=(r&n|i&~n)+t[11]+643717713|0,s=(s<<14|s>>>18)+r|0,n+=(s&i|r&~i)+t[0]-373897302|0,n=(n<<20|n>>>12)+s|0,i+=(n&r|s&~r)+t[5]-701558691|0,i=(i<<5|i>>>27)+n|0,r+=(i&s|n&~s)+t[10]+38016083|0,r=(r<<9|r>>>23)+i|0,s+=(r&n|i&~n)+t[15]-660478335|0,s=(s<<14|s>>>18)+r|0,n+=(s&i|r&~i)+t[4]-405537848|0,n=(n<<20|n>>>12)+s|0,i+=(n&r|s&~r)+t[9]+568446438|0,i=(i<<5|i>>>27)+n|0,r+=(i&s|n&~s)+t[14]-1019803690|0,r=(r<<9|r>>>23)+i|0,s+=(r&n|i&~n)+t[3]-187363961|0,s=(s<<14|s>>>18)+r|0,n+=(s&i|r&~i)+t[8]+1163531501|0,n=(n<<20|n>>>12)+s|0,i+=(n&r|s&~r)+t[13]-1444681467|0,i=(i<<5|i>>>27)+n|0,r+=(i&s|n&~s)+t[2]-51403784|0,r=(r<<9|r>>>23)+i|0,s+=(r&n|i&~n)+t[7]+1735328473|0,s=(s<<14|s>>>18)+r|0,n+=(s&i|r&~i)+t[12]-1926607734|0,n=(n<<20|n>>>12)+s|0,i+=(n^s^r)+t[5]-378558|0,i=(i<<4|i>>>28)+n|0,r+=(i^n^s)+t[8]-2022574463|0,r=(r<<11|r>>>21)+i|0,s+=(r^i^n)+t[11]+1839030562|0,s=(s<<16|s>>>16)+r|0,n+=(s^r^i)+t[14]-35309556|0,n=(n<<23|n>>>9)+s|0,i+=(n^s^r)+t[1]-1530992060|0,i=(i<<4|i>>>28)+n|0,r+=(i^n^s)+t[4]+1272893353|0,r=(r<<11|r>>>21)+i|0,s+=(r^i^n)+t[7]-155497632|0,s=(s<<16|s>>>16)+r|0,n+=(s^r^i)+t[10]-1094730640|0,n=(n<<23|n>>>9)+s|0,i+=(n^s^r)+t[13]+681279174|0,i=(i<<4|i>>>28)+n|0,r+=(i^n^s)+t[0]-358537222|0,r=(r<<11|r>>>21)+i|0,s+=(r^i^n)+t[3]-722521979|0,s=(s<<16|s>>>16)+r|0,n+=(s^r^i)+t[6]+76029189|0,n=(n<<23|n>>>9)+s|0,i+=(n^s^r)+t[9]-640364487|0,i=(i<<4|i>>>28)+n|0,r+=(i^n^s)+t[12]-421815835|0,r=(r<<11|r>>>21)+i|0,s+=(r^i^n)+t[15]+530742520|0,s=(s<<16|s>>>16)+r|0,n+=(s^r^i)+t[2]-995338651|0,n=(n<<23|n>>>9)+s|0,i+=(s^(n|~r))+t[0]-198630844|0,i=(i<<6|i>>>26)+n|0,r+=(n^(i|~s))+t[7]+1126891415|0,r=(r<<10|r>>>22)+i|0,s+=(i^(r|~n))+t[14]-1416354905|0,s=(s<<15|s>>>17)+r|0,n+=(r^(s|~i))+t[5]-57434055|0,n=(n<<21|n>>>11)+s|0,i+=(s^(n|~r))+t[12]+1700485571|0,i=(i<<6|i>>>26)+n|0,r+=(n^(i|~s))+t[3]-1894986606|0,r=(r<<10|r>>>22)+i|0,s+=(i^(r|~n))+t[10]-1051523|0,s=(s<<15|s>>>17)+r|0,n+=(r^(s|~i))+t[1]-2054922799|0,n=(n<<21|n>>>11)+s|0,i+=(s^(n|~r))+t[8]+1873313359|0,i=(i<<6|i>>>26)+n|0,r+=(n^(i|~s))+t[15]-30611744|0,r=(r<<10|r>>>22)+i|0,s+=(i^(r|~n))+t[6]-1560198380|0,s=(s<<15|s>>>17)+r|0,n+=(r^(s|~i))+t[13]+1309151649|0,n=(n<<21|n>>>11)+s|0,i+=(s^(n|~r))+t[4]-145523070|0,i=(i<<6|i>>>26)+n|0,r+=(n^(i|~s))+t[11]-1120210379|0,r=(r<<10|r>>>22)+i|0,s+=(i^(r|~n))+t[2]+718787259|0,s=(s<<15|s>>>17)+r|0,n+=(r^(s|~i))+t[9]-343485551|0,n=(n<<21|n>>>11)+s|0,e[0]=i+e[0]|0,e[1]=n+e[1]|0,e[2]=s+e[2]|0,e[3]=r+e[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(c.stateIdentity),this}appendStr(e){const t=this._buffer8,i=this._buffer32;let n,s,r=this._bufferLength;for(s=0;s<e.length;s+=1){if(n=e.charCodeAt(s),n<128)t[r++]=n;else if(n<2048)t[r++]=192+(n>>>6),t[r++]=63&n|128;else if(n<55296||n>56319)t[r++]=224+(n>>>12),t[r++]=n>>>6&63|128,t[r++]=63&n|128;else{if(n=1024*(n-55296)+(e.charCodeAt(++s)-56320)+65536,n>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");t[r++]=240+(n>>>18),t[r++]=n>>>12&63|128,t[r++]=n>>>6&63|128,t[r++]=63&n|128}r>=64&&(this._dataLength+=64,c._md5cycle(this._state,i),r-=64,i[0]=i[16])}return this._bufferLength=r,this}appendAsciiStr(e){const t=this._buffer8,i=this._buffer32;let n,s=this._bufferLength,r=0;for(;;){for(n=Math.min(e.length-r,64-s);n--;)t[s++]=e.charCodeAt(r++);if(s<64)break;this._dataLength+=64,c._md5cycle(this._state,i),s=0}return this._bufferLength=s,this}appendByteArray(e){const t=this._buffer8,i=this._buffer32;let n,s=this._bufferLength,r=0;for(;;){for(n=Math.min(e.length-r,64-s);n--;)t[s++]=e[r++];if(s<64)break;this._dataLength+=64,c._md5cycle(this._state,i),s=0}return this._bufferLength=s,this}getState(){const e=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[e[0],e[1],e[2],e[3]]}}setState(e){const t=e.buffer,i=e.state,n=this._state;let s;for(this._dataLength=e.length,this._bufferLength=e.buflen,n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],s=0;s<t.length;s+=1)this._buffer8[s]=t.charCodeAt(s)}end(e=!1){const t=this._bufferLength,i=this._buffer8,n=this._buffer32,s=1+(t>>2);this._dataLength+=t;const r=8*this._dataLength;if(i[t]=128,i[t+1]=i[t+2]=i[t+3]=0,n.set(c.buffer32Identity.subarray(s),s),t>55&&(c._md5cycle(this._state,n),n.set(c.buffer32Identity)),r<=4294967295)n[14]=r;else{const e=r.toString(16).match(/(.*?)(.{0,8})$/);if(null===e)return;const t=parseInt(e[2],16),i=parseInt(e[1],16)||0;n[14]=t,n[15]=i}return c._md5cycle(this._state,n),e?this._state:c._hex(this._state)}}if(c.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]),c.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),c.hexChars="0123456789abcdef",c.hexOut=[],c.onePassHasher=new c,"5d41402abc4b2a76b9719d911017c592"!==c.hashStr("hello"))throw new Error("Md5 self test failed.");function l(){return window.localStorage.getItem("lvdid")||function(){let e=navigator.userAgent.toLocaleLowerCase(),t="cd_"+c.hashStr(e+((new Date).getTime()+Math.floor(1e4*Math.random())/1e4));return window.localStorage.setItem("lvdid",t),t}()}const p={log_id:{origin:"handler",handlerId:"getLogId"},event_time:{origin:"handler",handlerId:"getEventTime"},game_id:{origin:"handler",handlerId:"getGameId"},pub_id:{origin:"handler",handlerId:"getPubId"},tunnel_id:{origin:"handler",handlerId:"getTunnelId"},platform:{origin:"handler",handlerId:"getPlatform"},app_version:{origin:"sdk",default:"",paramId:!1},device_id:{origin:"handler",handlerId:"getDeviced"},cpsdk_version:{origin:"sdk",paramId:"cpsdk_version"},cpsdk_account_id:{origin:"sdk",paramId:"cpsdk_account_id"},device_os:{origin:"handler",handlerId:"getDeviceOs"},device_version:{origin:"handler",handlerId:"getDeviceVersion"},device_nm:{origin:"sdk",default:"",paramId:!1},device_score:{origin:"sdk",default:"",paramId:!1},device_name:{origin:"sdk",default:"",paramId:!1},device_screen:{origin:"handler",handlerId:"getDeviceScreen"},cpu_count:{origin:"sdk",default:"",paramId:!1},cpu_freq:{origin:"sdk",default:"",paramId:!1},cpu_model:{origin:"sdk",default:"",paramId:!1},cpu_mem:{origin:"sdk",default:"",paramId:!1},total_space:{origin:"sdk",default:"",paramId:!1},free_space:{origin:"sdk",default:"",paramId:!1},imei:{origin:"sdk",default:"",paramId:!1},oaid:{origin:"sdk",default:"",paramId:!1},android_id:{origin:"sdk",default:"",paramId:!1},is_emu:{origin:"sdk",default:"",paramId:!1},languages:{origin:"handler",handlerId:"getLanguages"},user_ip:{origin:"sdk",default:"",paramId:!1},project_id:{origin:"handler",handlerId:"getProjectId"},subgame_id:{origin:"handler",handlerId:"getSubgameId"},channel_id:{origin:"handler",handlerId:"getChannelId"},ad_id:{origin:"sdk",default:"",paramId:!1},pubsdk_version:{origin:"sdk",paramId:"pubsdk_version"},pubsdk_account_id:{origin:"sdk",paramId:"pubsdk_account_id"},pubsdk_account_name:{origin:"sdk",paramId:"pubsdk_account_name"},is_first_active:{origin:"sdk",paramId:"is_first_active"},ad_details:{origin:"sdk",default:"",paramId:!1}},u={cpglog:{glog_key:"t1",version:"1.0",reg:"game_id,pub_id,tunnel_id,platform,app_version,device_id,cpsdk_version,cpsdk_account_id",login:"game_id,pub_id,tunnel_id,platform,app_version,device_id,cpsdk_version,cpsdk_account_id",pay_success:"game_id,pub_id,tunnel_id,platform,app_version,device_id,cpsdk_version,cpsdk_account_id",heartbeat:"game_id,pub_id,tunnel_id,platform,app_version,device_id,cpsdk_version,cpsdk_account_id",create_role:"game_id,pub_id,tunnel_id,platform,app_version,device_id,cpsdk_version,cpsdk_account_id",role_login:"game_id,pub_id,tunnel_id,platform,app_version,device_id,cpsdk_version,cpsdk_account_id",select_server:"game_id,pub_id,tunnel_id,platform,app_version,device_id,cpsdk_version,cpsdk_account_id",level_up:"game_id,pub_id,tunnel_id,platform,app_version,device_id,cpsdk_version,cpsdk_account_id",vip_level_up:"game_id,pub_id,tunnel_id,platform,app_version,device_id,cpsdk_version,cpsdk_account_id",role_logout:"game_id,pub_id,tunnel_id,platform,app_version,device_id,cpsdk_version,cpsdk_account_id",pay_order:"game_id,pub_id,tunnel_id,platform,app_version,device_id,cpsdk_version,cpsdk_account_id",pay_order_client:"game_id,pub_id,tunnel_id,platform,app_version,device_id,cpsdk_version,cpsdk_account_id",active:"game_id,pub_id,tunnel_id,platform,app_version,device_id,cpsdk_version"},pubglog:{glog_key:"pt1",version:"1.0",reg:"platform,device_id,project_id,subgame_id,channel_id,ad_id,app_version,pubsdk_version,pubsdk_account_id",login:"platform,device_id,project_id,subgame_id,channel_id,ad_id,app_version,pubsdk_version,pubsdk_account_id",pay:"platform,device_id,project_id,subgame_id,channel_id,ad_id,app_version,pubsdk_version,pubsdk_account_id",heartbeat:"platform,device_id,project_id,subgame_id,channel_id,ad_id,app_version,pubsdk_version,pubsdk_account_id",select_server:"platform,device_id,project_id,subgame_id,channel_id,ad_id,app_version,pubsdk_version,pubsdk_account_id",create_role:"platform,device_id,project_id,subgame_id,channel_id,ad_id,app_version,pubsdk_version,pubsdk_account_id",role_login:"platform,device_id,project_id,subgame_id,channel_id,ad_id,app_version,pubsdk_version,pubsdk_account_id",level_up:"platform,device_id,project_id,subgame_id,channel_id,ad_id,app_version,pubsdk_version,pubsdk_account_id",vip_level_up:"platform,device_id,project_id,subgame_id,channel_id,ad_id,app_version,pubsdk_version,pubsdk_account_id",role_logout:"platform,device_id,project_id,subgame_id,channel_id,ad_id,app_version,pubsdk_version,pubsdk_account_id",pay_order:"platform,device_id,project_id,subgame_id,channel_id,ad_id,app_version,pubsdk_version,pubsdk_account_id",pay_order_client:"platform,device_id,project_id,subgame_id,channel_id,ad_id,app_version,pubsdk_version,pubsdk_account_id",active:"platform,device_id,device_os,device_version,device_nm,device_score,device_name,device_screen,cpu_count,cpu_freq,cpu_model,cpu_mem,total_space,free_space,imei,oaid,android_id,is_emu,languages,user_ip,project_id,subgame_id,channel_id,ad_id,app_version,pubsdk_version"}};const _={getLogId:()=>c.hashStr(+new Date+(Math.ceil(9999*Math.random())+""))+Math.ceil(9999*Math.random()),getIp:()=>{return e=void 0,t=void 0,n=function*(){let e="";return yield d.create({url:"https://pv.sohu.com/cityjson?ie=utf-8",type:"GET"}).then((t=>{const i=t.indexOf("{"),n=t.indexOf("}");e=JSON.parse(t.slice(i,n+1)).cip})),e},new((i=void 0)||(i=Promise))((function(s,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function o(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}d((n=n.apply(e,t||[])).next())}));var e,t,i,n},getEventTime:()=>"+"+n(0-(new Date).getTimezoneOffset()/60,2)+"00 "+function(e,t="year-month-day hour:min:sec"){let i;i="object"!=typeof e?new Date(e):e;const s=i.getFullYear()+"",r=i.getMonth()+1,a=i.getDate(),o=i.getHours(),d=i.getMinutes(),c=i.getSeconds();return t.replace("year",s).replace("month",n(r,2)+"").replace("day",n(a,2)+"").replace("hour",n(o,2)+"").replace("min",n(d,2)+"").replace("sec",n(c,2)+"")}(new Date),getGameId:()=>"1",getPubId:()=>"1",getTunnelId:()=>"1",getPlatform:()=>"3",getDeviced:()=>l(),getDeviceOs:()=>{switch(s().split(" ")[0]){case"windows":return"3";case"ios":return"1";case"android":return"2";default:return"0"}},getDeviceVersion:()=>s().split(" ")[1],getDeviceScreen:()=>`${window.innerWidth}*${window.innerHeight}`,getLanguages:()=>navigator.languages||"zh",getProjectId:()=>a.getInstance().get("projectId"),getSubgameId:()=>a.getInstance().get("subgameId"),getChannelId:()=>"11"};let h,g,m,f={},v={};function b(e,t){if("other"==e){let e={};return t.map((t=>{e[t]=k(t)})),e}{let i={},n=u[h+"glog"];i.version=n.version,i.event=h+"sdk_"+e,["log_id","event_time"].concat(n[e].split(",")).map((e=>{i[e]=k(e)})),Object.assign(v,t),Object.assign(i,t),I([i])}}function k(e){let t=p[e];switch(t.origin){case"handler":return function(e){if(!e)return"";try{return _[e.handlerId]()}catch(e){}}(t);case"sdk":return function(e){return e?e.paramId?f[e.paramId]:e.default:""}(t)}}function w(e){Object.assign(f,e)}function I(e){d.create({url:"http://sdk-glog.iwgame.com/t1/"+u[h+"glog"].glog_key,data:e,type:"POST",ext:{notX8:!0}}).then((t=>{0!=t.code&&-1!=e.event.indexOf("heartbeat")&&function(e){let t=localStorage.getItem(h+"sdk_log")?JSON.parse(localStorage.getItem(h+"sdk_log")):[];localStorage.setItem(h+"sdk_log",JSON.stringify(t.concat(e))),m||(m=setTimeout((()=>{let e=localStorage.getItem(h+"sdk_log")?JSON.parse(localStorage.getItem(h+"sdk_log")):[];e.length>0&&I(e),m=null}),3e5))}(e),g||-1==e[0].event.indexOf("role_login")||(g=setInterval((()=>{b("heartbeat",v)}),3e5))}))}const S={code:200,msg:"成功"},y={code:9001,msg:"网络未知错误"},x={code:9003,msg:"CP WORK方法未实现"},O={code:60100,msg:"内部初始化失败"},j={code:60130,msg:"内部h5实现初始化失败"},D={code:60131,msg:"内部h5实现初始化加载发行资源失败"},P={code:60132,msg:"内部h5实现初始化加载发行SDK资源失败"},L={code:60133,msg:"内部h5实现初始化加载发行实现资源失败"},A={code:70131,msg:"h5work发行初始化失败"},T={code:70231,msg:"h5work发行登录失败"},E={code:70232,msg:"h5work登录失败"};function C(e,...t){return e.code==S.code?t.length>0&&o.commonS("[cp work]",...t):o.error(e.msg,"[cp work][code:]"+e.code,...t),Object.assign({},e)}let F=i(206).F;const M=i(147);class B{insideInit(e){o.commonS("h5work初始化开始。");let t=this.loadPublisherInfo();h="cp",t.then((()=>{w({cpsdk_version:M.version}),b("active",{is_first_active:r()}),e({cpSpace:this.getSpaceFunction()}),o.commonS("h5work初始化完成。")})).catch((e=>{C(D,e)}))}loadPublisherInfo(){return o.commonS("发行资源加载开始。"),new Promise(((e,t)=>{Promise.all([this.loadCpSDKFile(F),this.loadPublisherSDKFile(process.env.SDK_pubSDKResUrl,process.env.SDK_pubSDKPathType)]).then((t=>{o.commonS("发行资源加载结束。"),this.publisherSDk=new t[0],e(!0)})).catch((e=>{t(e)}))}))}loadCpSDKFile(e){return o.commonS("发行实现加载开始"),new Promise(((t,i)=>{o.commonS("发行实现加载完成"),e?t(e):(C(L),i({e:new Error("发行实现缺失"),pubCOde:"lvan"}))}))}loadPublisherSDKFile(e,t){return o.commonS("发行渠道sdk加载开始。"),new Promise(((i,n)=>{if("script"==t){o.commonS("发行渠道sdk script模式。");const e=document.createElement("script");window.sdkLoadCallback=()=>{o.commonS("发行渠道sdk加载完成。"),i(!0)},window.sdkLoadErrorBack=e=>{C(P,e),n(e)},e.textContent=process.env.SDK_pubSDKScript;let t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}else o.commonS("发行渠道sdk src模式。"),function(e,t,i,s){if(document.body){let i=document.createElement("script");i.src=e,i.onload=t,i.onerror=e=>{C(P,e),n(e)},s&&(i.type=s),document.body.append(i)}else document.write(`<script src="${e}" onload="${t()}"><\/script>`)}(e,(()=>{i(!0)}),0,t)}))}init(e){o.commonS("h5work 初始化开始");const{callback:t}=e;this.publisherSDk.init?this.noticePushlierInit(e):(o.commonS("h5work 初始化完成"),t(Object.assign({},C(S))))}noticePushlierInit(e){o.commonS("h5work发行初始化开始");const{callback:t,game_version:i}=e;this.publisherSDk.init({game_version:i}).then((e=>{let i=Object.assign({},C(S,"h5work发行初始化完成"));e.data&&(i.data=e.data),t(i)})).catch((e=>{t(Object.assign({},C(A,e)))}))}login(e){o.commonS("h5work发行登录开始");const{callback:t}=e;this.publisherSDk.login().then((e=>{o.commonS("h5work发行登录完成"),200==e.code&&this.insideLogin(e.data,t)})).catch((e=>{t(Object.assign({},C(T)))}))}insideLogin(e,t){o.commonS("h5work内部登录开始"),d.create({url:"http://cpsdk-demo-uat.iwgame.com/sdk/client/login",data:{zoneId:"1",tunnelId:"1",pubId:"1",gameId:"1",pubTokenInfo:JSON.stringify(Object.assign({},e)),deviceEnv:this.getDeviceEnv()},type:"POST"}).then((e=>{0==e.code?(w({cpsdk_account_id:e.data.cpsdkAccountId}),t(Object.assign(Object.assign({},C(S,"h5work内部登录成功")),{data:{cpsdkToken:e.data.cpsdkToken,tunnelId:e.data.tunnelId,zoneId:e.data.zoneId}}))):t(Object.assign({},C(E,e)))})).catch((e=>{t(Object.assign({},C(y,e)))}))}pay(e){o.commonS("h5work发行支付拉起开始"),this.publisherSDk.pay(e),b("pay_order_client",e)}getDeviceEnvOutSide(e){o.commonS("h5work环境信息获取开始");const{callback:t}=e;t&&t(this.getDeviceEnv())}getDeviceEnv(){return window.btoa(JSON.stringify({env:Object.assign({os:navigator.platform,deviceId:l(),serial:"",imei:"",androidId:"",oaid:"",idfa:"",ip:"",brand:"",mobileModel:""},b("other",["device_id","platform","app_version","cpsdk_version","pubsdk_version"])),pub:Object.assign({},b("other",["channel_id"]))}))}logout(){o.commonS("h5work发行登出开始"),this.publisherSDk.logout()}switchAccount(e){o.commonS("h5work发行切换账号开始");const{callback:t}=e;this.publisherSDk.switchAccount?this.publisherSDk.switchAccount().then((e=>{200==e.code&&this.insideLogin(e.data,t)})):this.publisherSDk.logout()}activeShare(){o.warn(function(e,...t){o.warn(e.msg,"[cp work][code:]"+e.code,...t)}(x))}onEventLog({eventCode:e,eventData:t}){o.commonS("数据上报开始",e,t),b(e,t),this.publisherSDk.report&&this.publisherSDk.report(e,t)}getSpaceFunction(){return{init:this.init.bind(this),login:this.login.bind(this),pay:this.pay.bind(this),logout:this.logout.bind(this),switchAccount:this.switchAccount.bind(this),getDeviceEnv:this.getDeviceEnvOutSide.bind(this),onEventLog:this.onEventLog.bind(this)}}}class N{static getInstance(){return N.instance||(N.instance=new N),this.instance}init(){return new Promise(((e,t)=>{(new B).insideInit(e)}))}}let K=new class{constructor(){this.insideInitState=!1,this.externalInitState=!1,o.timeStart("sdk_init_inside"),o.commonS("sdk内部初始化开始。"),this.init()}init(){let e;e=this.initH5(),e.then((({cpSpace:e})=>{this.judgeExternalInitState(e),o.commonS("sdk内部初始化结束。"),o.timeEnd("sdk_init_inside")})).catch((()=>{C(O)}))}initIos(){}initAndroid(){}initH5(){return o.commonS("h5初始化开始。"),new Promise((e=>{N.getInstance().init().then((t=>{o.commonS("h5初始化成功。"),e(t)})).catch((()=>{C(j)}))}))}externalInit(e){const{cpSpace:t}=e;this.insideInitState?(o.commonS("game-cp 内部初始化已完成"),Object.assign(t,this.insideInitResult.cpSpace),this.insideInitResult.cpSpace.init(e)):(o.commonS("game-cp 内部初始化未完成"),this.externalInitState=!0,this.externalInitParams=e,this.cpSpace=t)}judgeExternalInitState(e){this.externalInitState?(o.commonS("cp-game 外部初始化已执行"),Object.assign(this.cpSpace,e),e.init(this.externalInitParams)):(o.commonS("cp-game 等待外部初始化开始"),this.insideInitState=!0,this.insideInitResult={cpSpace:e})}};window.CPLASDK=class{static init(e){const{callback:t,game_version:i}=e;o.commonS("游戏调用sdk初始化开始。"),K.externalInit({cpSpace:this,callback:t,game_version:i})}}})()})();
//# sourceMappingURL=index.js.map